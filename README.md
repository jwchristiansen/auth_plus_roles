From https://hibbard.eu/authentication-with-devise-and-cancancan-in-rails/
